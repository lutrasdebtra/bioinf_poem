{# app/Resources/views/experiment/form.html.twig #}
{% extends "base.html.twig" %}

{% block title %}POEM - New Experiment{% endblock %}

{% block body %}
	<div class="experiment-form-div">
		<h1>New Experiment</h1>
		{{ form_start(form) }}
            {% do form.sampleNums.setRendered %}
            {% do form.rnaseqs.setRendered %}
			{{ form_errors(form) }}

    		{{ form_row(form.title) }}
            {{ form_label(form.sampleNums) }}
    		<div id="sampleNums-fields-list" data-prototype="{{ form_widget(form.sampleNums.vars.prototype)|e }}"></div>
        	{% for sampleNumsField in form.sampleNums %}
        		<div>
            		{{ form_errors(sampleNumsField) }}
            		{{ form_row(sampleNumsField) }}
				</div>
    		{% endfor %}
    		<a href="#" id="add-another-sampleNum">Add another Sample Number</a>
    		{# The JS uses prototype to create new dynamic fields #}
    		{{ form_row(form.expType, { 'label' : 'Experiment Type', 'id' : 'expType_drop'}) }}
			<div class="rnaseqs" data-prototype="{{ form_widget(form.rnaseqs.vars.prototype)|e }}">
				{% for rnaseq in form.rnaseqs %}
                    <div class="exptype-form-div">
                        <h3>RNA Seq Experiment</h3>
            			{{ form_row(rnaseq.quality) }}
                        {{ form_row(rnaseq.ribodepleted) }}
                        {{ form_row(rnaseq.finalQuality) }}
                        {{ form_row(rnaseq.sampleNum) }}
                        {{ form_row(rnaseq.protocolUsed) }}
                        {{ form_row(rnaseq.step1) }}
                        {{ form_row(rnaseq.step1Result) }}
                        {{ form_row(rnaseq.serviceProvider) }}
                        {{ form_row(rnaseq.platform) }}
                        {{ form_row(rnaseq.dataFiles) }}
                        {{ form_row(rnaseq.pipeline) }}
                        {{ form_row(rnaseq.pipelineParameters) }}
                        {{ form_row(rnaseq.resultFiles) }}
                    </div>
    			{% endfor %}
			</div>
        	{{ form_widget(form.save) }}
        {{ form_end(form) }}
    </div>
{% endblock %}
